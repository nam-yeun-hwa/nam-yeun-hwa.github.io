<!DOCTYPE html><html lang="en" class=""><head><meta charSet="utf-8"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/css/80c9ce4c138da48c.css" crossorigin="" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/0c496b0e03d530ba.css" crossorigin="" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/175d6c648827cdb6.css" crossorigin="" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-e047e1bf769d4490.js" crossorigin=""/><script src="/_next/static/chunks/fd9d1056-0e492acdb34e0e7d.js" async="" crossorigin=""></script><script src="/_next/static/chunks/938-073485517c55f951.js" async="" crossorigin=""></script><script src="/_next/static/chunks/main-app-f4b2590d9aab1ae2.js" async="" crossorigin=""></script><script src="/_next/static/chunks/250-8b90be581650ff9d.js" async=""></script><script src="/_next/static/chunks/399-caf055eb211349e2.js" async=""></script><script src="/_next/static/chunks/app/(layoutCase)/tags/%5Btagname%5D/%5Bpostid%5D/page-a0aaa490fd7693f1.js" async=""></script><script src="/_next/static/chunks/262-683004883e01034d.js" async=""></script><script src="/_next/static/chunks/35-17fdeaa71107664f.js" async=""></script><script src="/_next/static/chunks/app/(layoutCase)/layout-ad90720708a07259.js" async=""></script><title>be come 💡</title><meta name="description" content="App for an Ant Who Wants to Become a Bejjangyi"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" as="style"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+KR&amp;display=swap" as="style"/><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" crossorigin="" noModule=""></script></head><body><aside id="sidebar" class="sidemenu_sidebar__EmvJl"><header class="sidemenu_profile_wrapper__R57aU"><div class="sidemenu_profile__R1Mv0"><a href="/posts"><div class="imageLoader_imgloaderContainer__d3Tsu"><img alt="프로필이미지" loading="lazy" width="100" height="100" decoding="async" data-nimg="1" style="color:transparent;border-radius:50%;width:100%;height:auto" srcSet="https://nam-yeun-hwa.github.io/image/profile1.jpg?w=128&amp;q=75 1x, https://nam-yeun-hwa.github.io/image/profile1.jpg?w=256&amp;q=75 2x" src="https://nam-yeun-hwa.github.io/image/profile1.jpg?w=256&amp;q=75"/></div></a></div><h1 class="sidemenu_blog_name_txt__AfWhD">my blog</h1><p class="sidemenu_site_subtitle__eLcN7">You can only earn as much as an ant does by working like an ant.</p></header><nav><ul class="sidemenu_nav__6C5tz"><li class="sidemenu_nav_item__tt_B1"><a class="sidemenu_nav_link__WTCmf" href="/posts"><i class="fa-fw fas fa-home sidemenu_ico__6idJs"></i><span class="sidemenu_nav_txt__mSemS">HOME</span></a></li><li class="sidemenu_nav_item__tt_B1"><a class="sidemenu_nav_link__WTCmf" href="/categories"><i class="fa-fw fas fa-stream sidemenu_ico__6idJs"></i><span class="sidemenu_nav_txt__mSemS">CATEGORIES</span></a></li><li class="sidemenu_nav_item__tt_B1 sidemenu_active__fflT6"><a class="sidemenu_nav_link__WTCmf" href="/tags"><i class="fa-fw fas fa-tags sidemenu_ico__6idJs"></i><span class="sidemenu_nav_txt__mSemS">TAGS</span></a></li><li class="sidemenu_nav_item__tt_B1"><a class="sidemenu_nav_link__WTCmf" href="/archives"><i class="fa-fw fas fa-archive sidemenu_ico__6idJs"></i><span class="sidemenu_nav_txt__mSemS">ARCHIVES</span></a></li></ul></nav><div class="sidebar-bottom"></div></aside><div class="layout_main_wrapper__1M1Uy"><div class="contents_container__AfHAx"><header class="breadCrumb_topbar_wrapper__dGN_V"><div class="breadCrumb_top_bar__b_rV9"><nav class="breadCrumb_breadcrumb__l7WLX"><span><a class="breadCrumb_topbar_txt__ExrWf" href="/">Home</a><a class="breadCrumb_topbar_txt__ExrWf" href="">JWT와 토큰 관리 방법</a></span></nav><search class="searchBar_search__Ftlhc"><i class="fas fa-search fa-fw searchBar_search_ico__STStc"></i><input id="search" class="searchBar_search_input__1XpQF" placeholder="Search..." autoComplete="off" value=""/></search></div><div class="breadCrumb_mobile_topbar__N1Azi"><button class="breadCrumb_sidebar_trigger__APgD8"><i class="fas fa-bars fa-fw breadCrumb_sidebar_trigger_ico__K9DdV"></i></button><div class="breadCrumb_mobile_topbar_title__oCVBS">be come 💡</div><button class="breadCrumb_search_trigger__PxWyf"><i class="fas fa-search fa-fw breadCrumb_search_trigger_ico__yqqpz"></i></button></div></header><div class="contents_contents__Hpf57"><main class="contents_inner_content__wyt37"><article><header><h1 class="postUserInfo_h1__uhAqy">JWT와 토큰 관리 방법</h1></header></article><div class="postUserInfo_post_meta__ABvuC"><span>Posted<!-- --> <time class="postUserInfo_time__2exyR">3 years<!-- --> </time></span><span class="postUserInfo_update__f345P">Updated<!-- --> <time class="postUserInfo_time__2exyR">3 years</time></span></div><div><span class="postUserInfo_post_meta__ABvuC">By<!-- --> <em><a class="postUserInfo_author__fVGYM" href="https://nam-yeun-hwa.github.io/">베짱이가 되고싶은 개미。</a></em></span></div><div class="postDetail_content__OTeO2">JWT(JSON Web Token)는 JSON 객체를 사용하여 모바일이나 웹의 사용자 인증을 위해 사용하며 정보를 안전성 있게 암호화한 토큰을 의미한다.</div><h4 class="heading_h4__ZTbA0" style="font-weight:NORMAL">📝 <!-- -->Access Token</h4><div class="postDetail_content__OTeO2">액세스 토큰은 주로 인증된 사용자가 보호된 리소스에 접근할 수 있는 권한을 부여하는 데 사용되는 문자열입니다. 주로 웹 애플리케이션, 모바일 앱 등에서 사용자 인증 및 권한 부여에 쓰입니다. 여러 인증 프로토콜에서 사용되며, 대표적으로 OAuth 2.0에서 정의되어 있으며<br /><br />기본적으로 Access Token은 다음과 같은 특징을 가지고 있다.</div><ul class="liststyle_ul__uFdBS"><li class="liststyle_dot__SMzS4"><b>유효 기간(Expiration)</b> : Access Token은 일정 기간 동안만 유효하다. 일반적으로 짧은 시간(예: 2시간) 동안만 유효하며, 이 기간이 지나면 재발급이나 새로운 인증이 필요하다.</li><li class="liststyle_dot__SMzS4">        <b>권한 범위(범위)</b> : Access Token에는 사용자가 수행할 수 있는 특정 작업 또는 리소스에 대한 권한 범위가 지정된다. Scope는 해당 토큰으로 어떤 작업이 가능한지를 결정하는 데 사용된다.</li><li class="liststyle_dot__SMzS4">        <b>발급자(Issuer)</b> : 토큰을 발급한 인증 서버(발급자)의 정보가 토큰에 포함될 수 있다. 클라이언트는 이 정보를 사용하여 토큰의 신뢰성을 확인할 수 있다.</li><li class="liststyle_dot__SMzS4">        <b>서명(Signature)</b> : 보안을 강화하기 위해 토큰은 발급자에 의해 서명된다. 서명을 통해 토큰이 유효하며 조작되지 않았음을 검증할 수 있다.</li><li class="liststyle_dot__SMzS4">        <b>사용자 식별 정보</b> : Access Token에는 사용자를 고유하게 식별할 수 있는 정보(사용자 ID 등)가 포함될 수 있다. 이를 통해 서버는 특정 사용자에 대한 작업을 수행할 수 있다.</li></ul><h4 class="heading_h4__ZTbA0" style="font-weight:NORMAL">📝 <!-- -->Refresh token</h4><div class="postDetail_content__OTeO2">access 토큰이 만료가 됐을 경우 access 토큰을 재발급 받을 수 있도록 서버에 요청할 수 있다. fresh token은 access token을 재발급받을 수 있는 token이다. 이 token은 서버에 저장되기 때문에(stateful) refresh token이 해커에 의해 탈취당했다고 판단되었을 때 서버에서 refresh token을 삭제함으로써 강제 로그아웃을 시킬 수 있다.<br /><br />

        이런 특징을 이용해서 access token + refresh token의 조합을 구성하면 access token의 경제적인 장점과 refresh token의 보안적인 장점을 둘 다 챙길 수 있다. access token은 보안 적으로 취약하니 2시간 정도로 짧게 가져가고, refresh token은 처리 비용이 많이 들기 때문에 2주 정도로 길게 가져가는 방식을 주로 사용한다.</div><div class="LanguageConsole_console_container__AqYGR"><div class="LanguageConsole_console_header__inJS4"><span class="LanguageConsole_title__QSrQq" data-label-text="Javascript"><i class="fas fa-code fa-fw small LanguageConsole_ico_title__oetQW"></i></span><button class="LanguageConsole_copy__l7rff"><i class="far fa-clipboard LanguageConsole_ico_clipboard__tvVJz"></i></button></div><div class="LanguageConsole_console_content__O4Cw8"><pre class="LanguageConsole_console_code__9O_nt">client.interceptors.request.use(
    function (config) {
        const user = localStorage.getItem(&#x27;user&#x27;);
        if (!user) {
            config.headers[&quot;accessToken&quot;] = null;
            config.headers[&quot;refreshToken&quot;] = null;
            return config
        }
        const { accessToken, refreshToken } = JSON.parse(user)
        config.headers[&quot;accessToken&quot;] = accessToken;
        config.headers[&quot;refreshToken&quot;] = refreshToken;
        return config
    }
)</pre></div></div><div class="postDetail_content__OTeO2">reqeust를 보낼때 localStorage에 token 정보가 있다면 헤더에 토큰 정보를 저장하고 없다면 null로 처리를 한다.</div><div class="LanguageConsole_console_container__AqYGR"><div class="LanguageConsole_console_header__inJS4"><span class="LanguageConsole_title__QSrQq" data-label-text="Javascript"><i class="fas fa-code fa-fw small LanguageConsole_ico_title__oetQW"></i></span><button class="LanguageConsole_copy__l7rff"><i class="far fa-clipboard LanguageConsole_ico_clipboard__tvVJz"></i></button></div><div class="LanguageConsole_console_content__O4Cw8"><pre class="LanguageConsole_console_code__9O_nt">client.interceptors.response.use(
    function (response) {
        return response
    },
    async function (error) {
      if (error.response &amp;&amp; error.response.status === 403) {
          try {
              const originalRequest = error.config;
              const data = await client.get(&#x27;auth/refreshtoken&#x27;)
              if (data) {
                  const {accessToken, refreshToken} = data.data
                  localStorage.removeItem(&#x27;user&#x27;)
                  localStorage.setItem(&#x27;user&#x27;, JSON.stringify(data.data, [&#x27;accessToken&#x27;, &#x27;refreshToken&#x27;]))
                  originalRequest.headers[&#x27;accessToken&#x27;] = accessToken;
                  originalRequest.headers[&#x27;refreshToken&#x27;] = refreshToken;
                  return await client.request(originalRequest);
                  }
          } catch (error){
              localStorage.removeItem(&#x27;user&#x27;);
              console.log(error);
          }
          return Promise.reject(error)
      }
      return Promise.reject(error)
    }
)</pre></div></div><div class="postDetail_content__OTeO2">response를 받았을 때, error가 발생했고 해당 error의 status가 403이라면 기존의 originalRequest를 auth/refreshtoken 으로 전달해 토큰을 재발급 받도록 한다.<br /><br />
        여기서 403 이외의 오류가 들어온다면 토큰 재발급에 실패한것으로 처리를 한다.<br /><br />
        재발급 받은 토큰을 다시 로컬스토리지에 저장 하고 헤더 부분에 토큰 정보를 변경하고 다시 originalRequest를 보낸다.</div><div class="LanguageConsole_console_container__AqYGR"><div class="LanguageConsole_console_header__inJS4"><span class="LanguageConsole_title__QSrQq" data-label-text="Javascript"><i class="fas fa-code fa-fw small LanguageConsole_ico_title__oetQW"></i></span><button class="LanguageConsole_copy__l7rff"><i class="far fa-clipboard LanguageConsole_ico_clipboard__tvVJz"></i></button></div><div class="LanguageConsole_console_content__O4Cw8"><pre class="LanguageConsole_console_code__9O_nt">import axios from &#x27;axios&#x27;;

const client = axios.create({
    baseURL: &#x27;http://localhost:4000/&#x27;
})

client.interceptors.request.use(
    function (config) {
        const user = localStorage.getItem(&#x27;user&#x27;);
        if (!user) {
            config.headers[&quot;accessToken&quot;] = null;
            config.headers[&quot;refreshToken&quot;] = null;
            return config
        }
        const { accessToken, refreshToken } = JSON.parse(user)
        config.headers[&quot;accessToken&quot;] = accessToken;
        config.headers[&quot;refreshToken&quot;] = refreshToken;
        return config
    }
)

client.interceptors.response.use(
    function (response) {
        return response
    },
    async function (error) {
      if (error.response &amp;&amp; error.response.status === 403) {
          try {
              const originalRequest = error.config;
              const data = await client.get(&#x27;auth/refreshtoken&#x27;)
              if (data) {
                  const {accessToken, refreshToken} = data.data
                  localStorage.removeItem(&#x27;user&#x27;)
                  localStorage.setItem(&#x27;user&#x27;, JSON.stringify(data.data, [&#x27;accessToken&#x27;, &#x27;refreshToken&#x27;]))
                  originalRequest.headers[&#x27;accessToken&#x27;] = accessToken;
                  originalRequest.headers[&#x27;refreshToken&#x27;] = refreshToken;
                  return await client.request(originalRequest);
                  }
          } catch (error){
              localStorage.removeItem(&#x27;user&#x27;);
              console.log(error);
          }
          return Promise.reject(error)
      }
      return Promise.reject(error)
    }
)

export default client;</pre></div></div><h2 class="heading_h2__fsXMw" style="font-weight:NORMAL">보안</h2><h2 class="heading_h2__fsXMw" style="font-weight:NORMAL">CSRF(Cross Site Request Forgery)</h2><div class="postDetail_content__OTeO2">CSRF는 Cross-Site Request Forgery의 약자로, 한 사이트에서 인증된 사용자의 권한을 가로채어 다른 사이트에서 공격자가 의도한 동작을 수행하게 하는 공격이다. 이 공격은 사용자가 자신의 의지와 무관하게 공격자가 의도한 요청을 악의적인 웹사이트를 통해 전송함으로써 이루어진다.</div><h4 class="heading_h4__ZTbA0" style="font-weight:NORMAL">📝 <!-- -->CSRF 작동 원리</h4><ul class="liststyle_ul__uFdBS"><li class="liststyle_dot__SMzS4">사용자가 특정 웹사이트에 로그인하여 인증을 받는다.</li><li class="liststyle_dot__SMzS4">          이 사용자가 다른 웹사이트(공격자의 사이트)를 방문한다.</li><li class="liststyle_dot__SMzS4">         공격자의 사이트에서는 사용자의 권한으로 특정 동작(예: 글쓰기, 계정 변경 등)을 요청하는 HTTP 요청을 생성한다.</li><li class="liststyle_dot__SMzS4">         이를 트리거하기 위해 공격자는 이미 로그인된 사용자의 브라우저에서 악의적인 요청을 보낼 수 있는 방법을 찾는다.</li></ul><h4 class="heading_h4__ZTbA0" style="font-weight:NORMAL">📝 <!-- -->예시 시나리오</h4><ul class="liststyle_ul__uFdBS"><li class="liststyle_dot__SMzS4">사용자 A가 은행 웹사이트에 로그인한다.</li><li class="liststyle_dot__SMzS4">        사용자 A가 악의적인 이메일 링크를 클릭하여 공격자의 웹사이트에 접속한다.</li><li class="liststyle_dot__SMzS4">        해당 웹사이트에서는 사용자 A의 권한으로 은행 웹사이트에 자동으로 자금 이체를 요청하는 HTTP 요청을 생성한다.</li><li class="liststyle_dot__SMzS4">        이를 통해 은행 웹사이트는 사용자 A의 권한으로 이체를 실행하게 된다.</li></ul><h2 class="heading_h2__fsXMw" style="font-weight:NORMAL">XSS(Cross Site Scripting)</h2><div class="postDetail_content__OTeO2">XSS라고 불리는 이유는 CSS가 이미 약자가 있기 때문이고 code injection attack이라고도 한다.

        XSS도 다양한 공격 방법이 있는데 우선은
        <b>공격자가 의도하는 악의적인 js 코드를 피해자의 웹 브라우저에서 실행</b>시키는 것 정도로 알고 있으면 된다.
        
        이 방법으로 피해자 브라우저에 저장된 중요 정보들을 탈취 가능하다.</div><h2 class="heading_h2__fsXMw" style="font-weight:NORMAL">해결 1) localStorage에 저장하는 방법</h2><h4 class="heading_h4__ZTbA0" style="font-weight:NORMAL">📝 <!-- -->CSRF 공격에는 안전하다.</h4><div class="postDetail_content__OTeO2">그 이유는 자동으로 request에 담기는 쿠키와는 다르게 js 코드에 의해 헤더에 담기므로 XSS를 뚫지 않는 이상 공격자가 정상적인 사용자인 척 request를 보내기가 어렵다.</div><h4 class="heading_h4__ZTbA0" style="font-weight:NORMAL">📝 <!-- -->XSS에 취약하다.</h4><div class="postDetail_content__OTeO2">공격자가 localStorage에 접근하는 js 코드 한 줄만 주입하면 localStorage를 공격자가 내 집처럼 드나들 수 있다.</div><h2 class="heading_h2__fsXMw" style="font-weight:NORMAL">해결 2) cookie에 저장하는 방법</h2><h4 class="heading_h4__ZTbA0" style="font-weight:NORMAL">📝 <!-- -->XSS 공격으로부터 localStorage에 비해 안전하다.</h4><div class="postDetail_content__OTeO2">쿠키의 httpOnly 옵션을 사용하면 Js에서 쿠키에 접근 자체가 불가능하다.<br />
        그래서 XSS 공격으로 쿠키 정보를 탈취할 수 없다.(httpOnly 옵션은 서버에서 설정할 수 있음) 하지만 XSS 공격으로부터 완전히 안전한 것은 아니다.</div><div class="postDetail_content__OTeO2">httpOnly 옵션으로 쿠키의 내용을 볼 수 없다 해도 js로 request를 보낼 수 있으므로 자동으로 request에 실리는 쿠키의 특성 상 사용자의 컴퓨터에서 요청을 위조할 수 있기 때문이다.<br />
        공격자가 귀찮을 뿐이지 XSS가 뚫린다면 httpOnly cookie도 안전하진 않다.</div><h4 class="heading_h4__ZTbA0" style="font-weight:NORMAL">📝 <!-- -->CSRF 공격에 취약하다.</h4><div class="postDetail_content__OTeO2">자동으로 http request에 담아서 보내기 때문에 공격자가 request url만 안다면 사용자가 관련 link를 클릭하도록 유도하여 request를 위조하기 쉽다.</div><h2 class="heading_h2__fsXMw" style="font-weight:NORMAL">해결 3 : refresh token 사용하는 방법</h2><div class="postDetail_content__OTeO2">가장 좋은 방법으로는 refresh token을 사용하는 방법이 있다. CSRF 공격으로부터 안전한 환경을 유지하기 위해 쿠키에 SameSite 속성을 설정하고, 리프레시 토큰을 활용하여 요청의 유효성을 검증하는 방법이다. 백엔드 api 개발자와 소통이 가능하다면 refresh token을 httpOnly 쿠키로 설정하고
        url이 새로고침 될 때마다 refresh token을 request에 담아 새로운 accessToken을 발급 받는다. <br /><br />
        
        발급 받은 accessToken은 js private variable에 저장한다.<br /><br />
        
        이런 방식을 사용하는 경우, refresh token이 CSRF에 의해 사용된다 하더라도 공격자는 accessToken을 알 수 없다.<br /><br />
        
        CSRF는 피해자의 컴퓨터를 제어할 수 있는 것이 아니기 때문이다. 요청을 위조하여 피해자가 의도하지 않은 서버 동작을 일으키는 공격방법이기 때문에 refresh token을 통해 받아온 response(accessToken)는 공격자가 확인할 수 없다.<br /><br />
        
        따라서 쿠키를 사용하여 XSS를 막고 refresh token 방식을 이용하여 CSRF를 막을 수 있다.</div><div class="row"><nav class="postNavigation_post_navigation__Zbcpm"><a class="postNavigation_post_navgation_common__q8_Hl postNavigation_post_navigation_pre__SPHh_" aria-label="Older" href="/posts/2"><p class="postNavigation_post_navigation_text__3cjma">프로미스(Promise)의 세 가지 상태와 활용</p></a><a class="postNavigation_post_navgation_common__q8_Hl postNavigation_post_navigation_next__yVEzg postNavigation_post_not_cursor___7LQp" aria-label="Newer" href="/posts/0"><p class="postNavigation_post_navigation_text__3cjma">-</p></a></nav></div><div class="footer_footer_container__MsSvO"><footer class="footer_footer__AwYty"><p class="footer_copylight___J5l0">© 2024 <!-- -->베짱이가 되고싶은 개미。<!-- --> Some rights reserved.</p><p class="footer_theme__bwXbg">portfolio v1.0.0-alpha.3</p></footer></div></main><aside class="panel_panel_wrapper__bjPKT"><div class="panel_access__NiFhF"><section class="panel_access_lastmod__v6pgX"><h2 class="panel_panel_heading__n9W6w">Recently Updated</h2><ul class="panel_panel_recently__U0_Zp"><li class="panel_text_truncate__SFfHf"><a href="/posts/85">[TECH-QA] ?? (Nullish Coalescing Operator)와 !! (이중 부정 연산자)</a></li><li class="panel_text_truncate__SFfHf"><a href="/posts/84">[TECH-QA] Lodash compact 함수</a></li><li class="panel_text_truncate__SFfHf"><a href="/posts/83">[TECH-QA] ES6+에서 _.omit, _.pick, 객체 디스트럭처링(...rest)</a></li><li class="panel_text_truncate__SFfHf"><a href="/posts/82">[TECH-QA] class-variance-authority 라이브러리</a></li><li class="panel_text_truncate__SFfHf"><a href="/posts/81">[TECH-QA] React에서 SVG 아이콘 다루기: 실용적인 예제와 팁</a></li></ul></section><section class="panel_panel_tag_contain__h_Bwi"><h2 class="panel_panel_heading__n9W6w">Trending Tags</h2><div class="panel_panel_tag__eNz5c"><a class="panel_tag__3AiMO" href="/tags/TECH-QA">TECH-QA</a><a class="panel_tag__3AiMO" href="/tags/Javascript">Javascript</a><a class="panel_tag__3AiMO" href="/tags/tailwind">tailwind</a><a class="panel_tag__3AiMO" href="/tags/style">style</a><a class="panel_tag__3AiMO" href="/tags/CVA">CVA</a><a class="panel_tag__3AiMO" href="/tags/SVG">SVG</a><a class="panel_tag__3AiMO" href="/tags/%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80">브라우저</a><a class="panel_tag__3AiMO" href="/tags/%EC%9B%B9%EC%84%B1%EB%8A%A5%EC%B5%9C%EC%A0%81%ED%99%94">웹성능최적화</a><a class="panel_tag__3AiMO" href="/tags/TypeScript">TypeScript</a><a class="panel_tag__3AiMO" href="/tags/NextAuth">NextAuth</a><a class="panel_tag__3AiMO" href="/tags/React">React</a><a class="panel_tag__3AiMO" href="/tags/%EB%A6%AC%EC%95%A1%ED%8A%B8">리액트</a><a class="panel_tag__3AiMO" href="/tags/%ED%8C%A9%ED%86%A0%EB%A6%AC%ED%8C%A8%ED%84%B4">팩토리패턴</a><a class="panel_tag__3AiMO" href="/tags/Reflow">Reflow</a><a class="panel_tag__3AiMO" href="/tags/Repaint">Repaint</a><a class="panel_tag__3AiMO" href="/tags/%EB%A6%AC%ED%94%8C%EB%A1%9C%EC%9A%B0">리플로우</a><a class="panel_tag__3AiMO" href="/tags/%EB%A6%AC%ED%8E%98%EC%9D%B8%ED%8A%B8">리페인트</a><a class="panel_tag__3AiMO" href="/tags/%EC%9B%B9%EC%84%B1%EB%8A%A5%20%EC%B5%9C%EC%A0%81%ED%99%94">웹성능 최적화</a><a class="panel_tag__3AiMO" href="/tags/react">react</a><a class="panel_tag__3AiMO" href="/tags/XSS">XSS</a><a class="panel_tag__3AiMO" href="/tags/JavaScript">JavaScript</a><a class="panel_tag__3AiMO" href="/tags/CSRF">CSRF</a><a class="panel_tag__3AiMO" href="/tags/%EB%A6%AC%EB%A0%8C%EB%8D%94%EB%A7%81">리렌더링</a><a class="panel_tag__3AiMO" href="/tags/Prototype">Prototype</a><a class="panel_tag__3AiMO" href="/tags/JWT">JWT</a><a class="panel_tag__3AiMO" href="/tags/English">English</a><a class="panel_tag__3AiMO" href="/tags/midjourney">midjourney</a><a class="panel_tag__3AiMO" href="/tags/%EC%8A%A4%ED%82%A4%EB%84%88%EC%9D%98%20%EC%8B%AC%EB%A6%AC%EC%83%81%EC%9E%90%20%EC%97%B4%EA%B8%B0">스키너의 심리상자 열기</a><a class="panel_tag__3AiMO" href="/tags/%EB%8F%85%EC%84%9C">독서</a><a class="panel_tag__3AiMO" href="/tags/next">next</a><a class="panel_tag__3AiMO" href="/tags/%EC%A7%80%EC%97%B0%EB%A1%9C%EB%94%A9">지연로딩</a><a class="panel_tag__3AiMO" href="/tags/Lazy-loading">Lazy-loading</a><a class="panel_tag__3AiMO" href="/tags/CSS">CSS</a><a class="panel_tag__3AiMO" href="/tags/Tailwind">Tailwind</a><a class="panel_tag__3AiMO" href="/tags/mysql">mysql</a><a class="panel_tag__3AiMO" href="/tags/database">database</a><a class="panel_tag__3AiMO" href="/tags/TDD">TDD</a><a class="panel_tag__3AiMO" href="/tags/%EC%BD%9C%EB%B0%B1%ED%95%A8%EC%88%98">콜백함수</a><a class="panel_tag__3AiMO" href="/tags/browser">browser</a><a class="panel_tag__3AiMO" href="/tags/HTTP-Protocol">HTTP-Protocol</a><a class="panel_tag__3AiMO" href="/tags/git">git</a><a class="panel_tag__3AiMO" href="/tags/FrontEnd">FrontEnd</a><a class="panel_tag__3AiMO" href="/tags/Vue">Vue</a></div></section></div></aside></div></div></div><script src="/_next/static/chunks/webpack-e047e1bf769d4490.js" crossorigin="" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/80c9ce4c138da48c.css\",\"style\",{\"crossOrigin\":\"\"}]\n0:\"$L2\"\n"])</script><script>self.__next_f.push([1,"3:HL[\"/_next/static/css/0c496b0e03d530ba.css\",\"style\",{\"crossOrigin\":\"\"}]\n4:HL[\"/_next/static/css/175d6c648827cdb6.css\",\"style\",{\"crossOrigin\":\"\"}]\n"])</script><script>self.__next_f.push([1,"5:I[7690,[],\"\"]\n7:I[5250,[\"250\",\"static/chunks/250-8b90be581650ff9d.js\",\"399\",\"static/chunks/399-caf055eb211349e2.js\",\"216\",\"static/chunks/app/(layoutCase)/tags/%5Btagname%5D/%5Bpostid%5D/page-a0aaa490fd7693f1.js\"],\"\"]\n8:I[8843,[\"250\",\"static/chunks/250-8b90be581650ff9d.js\",\"399\",\"static/chunks/399-caf055eb211349e2.js\",\"216\",\"static/chunks/app/(layoutCase)/tags/%5Btagname%5D/%5Bpostid%5D/page-a0aaa490fd7693f1.js\"],\"\"]\na:I[777,[\"250\",\"static/chunks/250-8b90be581650ff9d.js\",\"399\",\"static/chunks/399-caf055eb21"])</script><script>self.__next_f.push([1,"1349e2.js\",\"216\",\"static/chunks/app/(layoutCase)/tags/%5Btagname%5D/%5Bpostid%5D/page-a0aaa490fd7693f1.js\"],\"\"]\nb:I[5613,[],\"\"]\ne:I[1778,[],\"\"]\n12:I[8765,[\"250\",\"static/chunks/250-8b90be581650ff9d.js\",\"399\",\"static/chunks/399-caf055eb211349e2.js\",\"262\",\"static/chunks/262-683004883e01034d.js\",\"35\",\"static/chunks/35-17fdeaa71107664f.js\",\"464\",\"static/chunks/app/(layoutCase)/layout-ad90720708a07259.js\"],\"\"]\n19:I[8955,[],\"\"]\n9:T638,"])</script><script>self.__next_f.push([1,"import axios from 'axios';\n\nconst client = axios.create({\n    baseURL: 'http://localhost:4000/'\n})\n\nclient.interceptors.request.use(\n    function (config) {\n        const user = localStorage.getItem('user');\n        if (!user) {\n            config.headers[\"accessToken\"] = null;\n            config.headers[\"refreshToken\"] = null;\n            return config\n        }\n        const { accessToken, refreshToken } = JSON.parse(user)\n        config.headers[\"accessToken\"] = accessToken;\n        config.headers[\"refreshToken\"] = refreshToken;\n        return config\n    }\n)\n\nclient.interceptors.response.use(\n    function (response) {\n        return response\n    },\n    async function (error) {\n      if (error.response \u0026\u0026 error.response.status === 403) {\n          try {\n              const originalRequest = error.config;\n              const data = await client.get('auth/refreshtoken')\n              if (data) {\n                  const {accessToken, refreshToken} = data.data\n                  localStorage.removeItem('user')\n                  localStorage.setItem('user', JSON.stringify(data.data, ['accessToken', 'refreshToken']))\n                  originalRequest.headers['accessToken'] = accessToken;\n                  originalRequest.headers['refreshToken'] = refreshToken;\n                  return await client.request(originalRequest);\n                  }\n          } catch (error){\n              localStorage.removeItem('user');\n              console.log(error);\n          }\n          return Promise.reject(error)\n      }\n      return Promise.reject(error)\n    }\n)\n\nexport default client;"])</script><script>self.__next_f.push([1,"c:[\"tagname\",\"%EB%A6%AC%EB%A0%8C%EB%8D%94%EB%A7%81\",\"d\"]\nd:[\"postid\",\"1\",\"d\"]\nf:\"$L10\"\n13:[]\n14:{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"}\n15:{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"}\n16:{\"display\":\"inline-blo"])</script><script>self.__next_f.push([1,"ck\"}\n17:{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0}\n"])</script><script>self.__next_f.push([1,"2:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/80c9ce4c138da48c.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]],[\"$\",\"$L5\",null,{\"buildId\":\"eAYovxfDYhWXk36E6nr0a\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/tags/%EB%A6%AC%EB%A0%8C%EB%8D%94%EB%A7%81/1\",\"initialTree\":[\"\",{\"children\":[\"(layoutCase)\",{\"children\":[\"tags\",{\"children\":[[\"tagname\",\"%EB%A6%AC%EB%A0%8C%EB%8D%94%EB%A7%81\",\"d\"],{\"children\":[[\"postid\",\"1\",\"d\"],{\"children\":[\"__PAGE__?{\\\"tagname\\\":\\\"리렌더링\\\",\\\"postid\\\":\\\"1\\\"}\",{}]}]}]}],\"search\":[\"__DEFAULT__\",{}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"(layoutCase)\",{\"children\":[\"tags\",{\"children\":[[\"tagname\",\"%EB%A6%AC%EB%A0%8C%EB%8D%94%EB%A7%81\",\"d\"],{\"children\":[[\"postid\",\"1\",\"d\"],{\"children\":[\"__PAGE__\",{},[\"$L6\",[[[\"$\",\"article\",null,{\"className\":\"$undefined\",\"children\":[\"$\",\"header\",null,{\"children\":[\"$\",\"h1\",null,{\"className\":\"postUserInfo_h1__uhAqy\",\"children\":\"JWT와 토큰 관리 방법\"}]}]}],[\"$\",\"div\",null,{\"className\":\"postUserInfo_post_meta__ABvuC\",\"children\":[[\"$\",\"span\",null,{\"children\":[\"Posted\",\" \",[\"$\",\"time\",null,{\"className\":\"postUserInfo_time__2exyR\",\"children\":[\"3 years\",\" \"]}]]}],[\"$\",\"span\",null,{\"className\":\"postUserInfo_update__f345P\",\"children\":[\"Updated\",\" \",[\"$\",\"time\",null,{\"className\":\"postUserInfo_time__2exyR\",\"children\":\"3 years\"}]]}]]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"span\",null,{\"className\":\"postUserInfo_post_meta__ABvuC\",\"children\":[\"By\",\" \",[\"$\",\"em\",null,{\"children\":[\"$\",\"$L7\",null,{\"href\":\"https://nam-yeun-hwa.github.io/\",\"className\":\"postUserInfo_author__fVGYM\",\"children\":\"베짱이가 되고싶은 개미。\"}]}]]}]}]],[[\"$\",\"div\",null,{\"className\":\"postDetail_content__OTeO2\",\"dangerouslySetInnerHTML\":{\"__html\":\"JWT(JSON Web Token)는 JSON 객체를 사용하여 모바일이나 웹의 사용자 인증을 위해 사용하며 정보를 안전성 있게 암호화한 토큰을 의미한다.\"}}],[false,false,false,[\"$\",\"h4\",null,{\"className\":\"heading_h4__ZTbA0\",\"style\":{\"fontWeight\":\"NORMAL\"},\"children\":[\"📝 \",\"Access Token\"]}]],[\"$\",\"div\",null,{\"className\":\"postDetail_content__OTeO2\",\"dangerouslySetInnerHTML\":{\"__html\":\"액세스 토큰은 주로 인증된 사용자가 보호된 리소스에 접근할 수 있는 권한을 부여하는 데 사용되는 문자열입니다. 주로 웹 애플리케이션, 모바일 앱 등에서 사용자 인증 및 권한 부여에 쓰입니다. 여러 인증 프로토콜에서 사용되며, 대표적으로 OAuth 2.0에서 정의되어 있으며\u003cbr /\u003e\u003cbr /\u003e기본적으로 Access Token은 다음과 같은 특징을 가지고 있다.\"}}],[\"$\",\"ul\",null,{\"className\":\"liststyle_ul__uFdBS\",\"children\":[[\"$\",\"li\",\"0\",{\"className\":\"liststyle_dot__SMzS4\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cb\u003e유효 기간(Expiration)\u003c/b\u003e : Access Token은 일정 기간 동안만 유효하다. 일반적으로 짧은 시간(예: 2시간) 동안만 유효하며, 이 기간이 지나면 재발급이나 새로운 인증이 필요하다.\"}}],\"$undefined\",[\"$\",\"li\",\"2\",{\"className\":\"liststyle_dot__SMzS4\",\"dangerouslySetInnerHTML\":{\"__html\":\"        \u003cb\u003e권한 범위(범위)\u003c/b\u003e : Access Token에는 사용자가 수행할 수 있는 특정 작업 또는 리소스에 대한 권한 범위가 지정된다. Scope는 해당 토큰으로 어떤 작업이 가능한지를 결정하는 데 사용된다.\"}}],\"$undefined\",[\"$\",\"li\",\"4\",{\"className\":\"liststyle_dot__SMzS4\",\"dangerouslySetInnerHTML\":{\"__html\":\"        \u003cb\u003e발급자(Issuer)\u003c/b\u003e : 토큰을 발급한 인증 서버(발급자)의 정보가 토큰에 포함될 수 있다. 클라이언트는 이 정보를 사용하여 토큰의 신뢰성을 확인할 수 있다.\"}}],\"$undefined\",[\"$\",\"li\",\"6\",{\"className\":\"liststyle_dot__SMzS4\",\"dangerouslySetInnerHTML\":{\"__html\":\"        \u003cb\u003e서명(Signature)\u003c/b\u003e : 보안을 강화하기 위해 토큰은 발급자에 의해 서명된다. 서명을 통해 토큰이 유효하며 조작되지 않았음을 검증할 수 있다.\"}}],\"$undefined\",[\"$\",\"li\",\"8\",{\"className\":\"liststyle_dot__SMzS4\",\"dangerouslySetInnerHTML\":{\"__html\":\"        \u003cb\u003e사용자 식별 정보\u003c/b\u003e : Access Token에는 사용자를 고유하게 식별할 수 있는 정보(사용자 ID 등)가 포함될 수 있다. 이를 통해 서버는 특정 사용자에 대한 작업을 수행할 수 있다.\"}}]]}],[false,false,false,[\"$\",\"h4\",null,{\"className\":\"heading_h4__ZTbA0\",\"style\":{\"fontWeight\":\"NORMAL\"},\"children\":[\"📝 \",\"Refresh token\"]}]],[\"$\",\"div\",null,{\"className\":\"postDetail_content__OTeO2\",\"dangerouslySetInnerHTML\":{\"__html\":\"access 토큰이 만료가 됐을 경우 access 토큰을 재발급 받을 수 있도록 서버에 요청할 수 있다. fresh token은 access token을 재발급받을 수 있는 token이다. 이 token은 서버에 저장되기 때문에(stateful) refresh token이 해커에 의해 탈취당했다고 판단되었을 때 서버에서 refresh token을 삭제함으로써 강제 로그아웃을 시킬 수 있다.\u003cbr /\u003e\u003cbr /\u003e\\n\\n        이런 특징을 이용해서 access token + refresh token의 조합을 구성하면 access token의 경제적인 장점과 refresh token의 보안적인 장점을 둘 다 챙길 수 있다. access token은 보안 적으로 취약하니 2시간 정도로 짧게 가져가고, refresh token은 처리 비용이 많이 들기 때문에 2주 정도로 길게 가져가는 방식을 주로 사용한다.\"}}],[\"$\",\"$L8\",null,{\"code\":\"client.interceptors.request.use(\\n    function (config) {\\n        const user = localStorage.getItem('user');\\n        if (!user) {\\n            config.headers[\\\"accessToken\\\"] = null;\\n            config.headers[\\\"refreshToken\\\"] = null;\\n            return config\\n        }\\n        const { accessToken, refreshToken } = JSON.parse(user)\\n        config.headers[\\\"accessToken\\\"] = accessToken;\\n        config.headers[\\\"refreshToken\\\"] = refreshToken;\\n        return config\\n    }\\n)\",\"children\":\"$undefined\"}],[\"$\",\"div\",null,{\"className\":\"postDetail_content__OTeO2\",\"dangerouslySetInnerHTML\":{\"__html\":\"reqeust를 보낼때 localStorage에 token 정보가 있다면 헤더에 토큰 정보를 저장하고 없다면 null로 처리를 한다.\"}}],[\"$\",\"$L8\",null,{\"code\":\"client.interceptors.response.use(\\n    function (response) {\\n        return response\\n    },\\n    async function (error) {\\n      if (error.response \u0026\u0026 error.response.status === 403) {\\n          try {\\n              const originalRequest = error.config;\\n              const data = await client.get('auth/refreshtoken')\\n              if (data) {\\n                  const {accessToken, refreshToken} = data.data\\n                  localStorage.removeItem('user')\\n                  localStorage.setItem('user', JSON.stringify(data.data, ['accessToken', 'refreshToken']))\\n                  originalRequest.headers['accessToken'] = accessToken;\\n                  originalRequest.headers['refreshToken'] = refreshToken;\\n                  return await client.request(originalRequest);\\n                  }\\n          } catch (error){\\n              localStorage.removeItem('user');\\n              console.log(error);\\n          }\\n          return Promise.reject(error)\\n      }\\n      return Promise.reject(error)\\n    }\\n)\",\"children\":\"$undefined\"}],[\"$\",\"div\",null,{\"className\":\"postDetail_content__OTeO2\",\"dangerouslySetInnerHTML\":{\"__html\":\"response를 받았을 때, error가 발생했고 해당 error의 status가 403이라면 기존의 originalRequest를 auth/refreshtoken 으로 전달해 토큰을 재발급 받도록 한다.\u003cbr /\u003e\u003cbr /\u003e\\n        여기서 403 이외의 오류가 들어온다면 토큰 재발급에 실패한것으로 처리를 한다.\u003cbr /\u003e\u003cbr /\u003e\\n        재발급 받은 토큰을 다시 로컬스토리지에 저장 하고 헤더 부분에 토큰 정보를 변경하고 다시 originalRequest를 보낸다.\"}}],[\"$\",\"$L8\",null,{\"code\":\"$9\",\"children\":\"$undefined\"}],[false,[\"$\",\"h2\",null,{\"className\":\"heading_h2__fsXMw\",\"style\":{\"fontWeight\":\"NORMAL\"},\"children\":\"보안\"}],false,false],[false,[\"$\",\"h2\",null,{\"className\":\"heading_h2__fsXMw\",\"style\":{\"fontWeight\":\"NORMAL\"},\"children\":\"CSRF(Cross Site Request Forgery)\"}],false,false],[\"$\",\"div\",null,{\"className\":\"postDetail_content__OTeO2\",\"dangerouslySetInnerHTML\":{\"__html\":\"CSRF는 Cross-Site Request Forgery의 약자로, 한 사이트에서 인증된 사용자의 권한을 가로채어 다른 사이트에서 공격자가 의도한 동작을 수행하게 하는 공격이다. 이 공격은 사용자가 자신의 의지와 무관하게 공격자가 의도한 요청을 악의적인 웹사이트를 통해 전송함으로써 이루어진다.\"}}],[false,false,false,[\"$\",\"h4\",null,{\"className\":\"heading_h4__ZTbA0\",\"style\":{\"fontWeight\":\"NORMAL\"},\"children\":[\"📝 \",\"CSRF 작동 원리\"]}]],[\"$\",\"ul\",null,{\"className\":\"liststyle_ul__uFdBS\",\"children\":[[\"$\",\"li\",\"0\",{\"className\":\"liststyle_dot__SMzS4\",\"dangerouslySetInnerHTML\":{\"__html\":\"사용자가 특정 웹사이트에 로그인하여 인증을 받는다.\"}}],[\"$\",\"li\",\"1\",{\"className\":\"liststyle_dot__SMzS4\",\"dangerouslySetInnerHTML\":{\"__html\":\"          이 사용자가 다른 웹사이트(공격자의 사이트)를 방문한다.\"}}],[\"$\",\"li\",\"2\",{\"className\":\"liststyle_dot__SMzS4\",\"dangerouslySetInnerHTML\":{\"__html\":\"         공격자의 사이트에서는 사용자의 권한으로 특정 동작(예: 글쓰기, 계정 변경 등)을 요청하는 HTTP 요청을 생성한다.\"}}],[\"$\",\"li\",\"3\",{\"className\":\"liststyle_dot__SMzS4\",\"dangerouslySetInnerHTML\":{\"__html\":\"         이를 트리거하기 위해 공격자는 이미 로그인된 사용자의 브라우저에서 악의적인 요청을 보낼 수 있는 방법을 찾는다.\"}}]]}],[false,false,false,[\"$\",\"h4\",null,{\"className\":\"heading_h4__ZTbA0\",\"style\":{\"fontWeight\":\"NORMAL\"},\"children\":[\"📝 \",\"예시 시나리오\"]}]],[\"$\",\"ul\",null,{\"className\":\"liststyle_ul__uFdBS\",\"children\":[[\"$\",\"li\",\"0\",{\"className\":\"liststyle_dot__SMzS4\",\"dangerouslySetInnerHTML\":{\"__html\":\"사용자 A가 은행 웹사이트에 로그인한다.\"}}],[\"$\",\"li\",\"1\",{\"className\":\"liststyle_dot__SMzS4\",\"dangerouslySetInnerHTML\":{\"__html\":\"        사용자 A가 악의적인 이메일 링크를 클릭하여 공격자의 웹사이트에 접속한다.\"}}],[\"$\",\"li\",\"2\",{\"className\":\"liststyle_dot__SMzS4\",\"dangerouslySetInnerHTML\":{\"__html\":\"        해당 웹사이트에서는 사용자 A의 권한으로 은행 웹사이트에 자동으로 자금 이체를 요청하는 HTTP 요청을 생성한다.\"}}],[\"$\",\"li\",\"3\",{\"className\":\"liststyle_dot__SMzS4\",\"dangerouslySetInnerHTML\":{\"__html\":\"        이를 통해 은행 웹사이트는 사용자 A의 권한으로 이체를 실행하게 된다.\"}}]]}],[false,[\"$\",\"h2\",null,{\"className\":\"heading_h2__fsXMw\",\"style\":{\"fontWeight\":\"NORMAL\"},\"children\":\"XSS(Cross Site Scripting)\"}],false,false],[\"$\",\"div\",null,{\"className\":\"postDetail_content__OTeO2\",\"dangerouslySetInnerHTML\":{\"__html\":\"XSS라고 불리는 이유는 CSS가 이미 약자가 있기 때문이고 code injection attack이라고도 한다.\\n\\n        XSS도 다양한 공격 방법이 있는데 우선은\\n        \u003cb\u003e공격자가 의도하는 악의적인 js 코드를 피해자의 웹 브라우저에서 실행\u003c/b\u003e시키는 것 정도로 알고 있으면 된다.\\n        \\n        이 방법으로 피해자 브라우저에 저장된 중요 정보들을 탈취 가능하다.\"}}],[false,false,false,false],[false,[\"$\",\"h2\",null,{\"className\":\"heading_h2__fsXMw\",\"style\":{\"fontWeight\":\"NORMAL\"},\"children\":\"해결 1) localStorage에 저장하는 방법\"}],false,false],[false,false,false,[\"$\",\"h4\",null,{\"className\":\"heading_h4__ZTbA0\",\"style\":{\"fontWeight\":\"NORMAL\"},\"children\":[\"📝 \",\"CSRF 공격에는 안전하다.\"]}]],[\"$\",\"div\",null,{\"className\":\"postDetail_content__OTeO2\",\"dangerouslySetInnerHTML\":{\"__html\":\"그 이유는 자동으로 request에 담기는 쿠키와는 다르게 js 코드에 의해 헤더에 담기므로 XSS를 뚫지 않는 이상 공격자가 정상적인 사용자인 척 request를 보내기가 어렵다.\"}}],[false,false,false,[\"$\",\"h4\",null,{\"className\":\"heading_h4__ZTbA0\",\"style\":{\"fontWeight\":\"NORMAL\"},\"children\":[\"📝 \",\"XSS에 취약하다.\"]}]],[\"$\",\"div\",null,{\"className\":\"postDetail_content__OTeO2\",\"dangerouslySetInnerHTML\":{\"__html\":\"공격자가 localStorage에 접근하는 js 코드 한 줄만 주입하면 localStorage를 공격자가 내 집처럼 드나들 수 있다.\"}}],[false,[\"$\",\"h2\",null,{\"className\":\"heading_h2__fsXMw\",\"style\":{\"fontWeight\":\"NORMAL\"},\"children\":\"해결 2) cookie에 저장하는 방법\"}],false,false],[false,false,false,[\"$\",\"h4\",null,{\"className\":\"heading_h4__ZTbA0\",\"style\":{\"fontWeight\":\"NORMAL\"},\"children\":[\"📝 \",\"XSS 공격으로부터 localStorage에 비해 안전하다.\"]}]],[\"$\",\"div\",null,{\"className\":\"postDetail_content__OTeO2\",\"dangerouslySetInnerHTML\":{\"__html\":\"쿠키의 httpOnly 옵션을 사용하면 Js에서 쿠키에 접근 자체가 불가능하다.\u003cbr /\u003e\\n        그래서 XSS 공격으로 쿠키 정보를 탈취할 수 없다.(httpOnly 옵션은 서버에서 설정할 수 있음) 하지만 XSS 공격으로부터 완전히 안전한 것은 아니다.\"}}],[\"$\",\"div\",null,{\"className\":\"postDetail_content__OTeO2\",\"dangerouslySetInnerHTML\":{\"__html\":\"httpOnly 옵션으로 쿠키의 내용을 볼 수 없다 해도 js로 request를 보낼 수 있으므로 자동으로 request에 실리는 쿠키의 특성 상 사용자의 컴퓨터에서 요청을 위조할 수 있기 때문이다.\u003cbr /\u003e\\n        공격자가 귀찮을 뿐이지 XSS가 뚫린다면 httpOnly cookie도 안전하진 않다.\"}}],[false,false,false,[\"$\",\"h4\",null,{\"className\":\"heading_h4__ZTbA0\",\"style\":{\"fontWeight\":\"NORMAL\"},\"children\":[\"📝 \",\"CSRF 공격에 취약하다.\"]}]],[\"$\",\"div\",null,{\"className\":\"postDetail_content__OTeO2\",\"dangerouslySetInnerHTML\":{\"__html\":\"자동으로 http request에 담아서 보내기 때문에 공격자가 request url만 안다면 사용자가 관련 link를 클릭하도록 유도하여 request를 위조하기 쉽다.\"}}],[false,[\"$\",\"h2\",null,{\"className\":\"heading_h2__fsXMw\",\"style\":{\"fontWeight\":\"NORMAL\"},\"children\":\"해결 3 : refresh token 사용하는 방법\"}],false,false],[\"$\",\"div\",null,{\"className\":\"postDetail_content__OTeO2\",\"dangerouslySetInnerHTML\":{\"__html\":\"가장 좋은 방법으로는 refresh token을 사용하는 방법이 있다. CSRF 공격으로부터 안전한 환경을 유지하기 위해 쿠키에 SameSite 속성을 설정하고, 리프레시 토큰을 활용하여 요청의 유효성을 검증하는 방법이다. 백엔드 api 개발자와 소통이 가능하다면 refresh token을 httpOnly 쿠키로 설정하고\\n        url이 새로고침 될 때마다 refresh token을 request에 담아 새로운 accessToken을 발급 받는다. \u003cbr /\u003e\u003cbr /\u003e\\n        \\n        발급 받은 accessToken은 js private variable에 저장한다.\u003cbr /\u003e\u003cbr /\u003e\\n        \\n        이런 방식을 사용하는 경우, refresh token이 CSRF에 의해 사용된다 하더라도 공격자는 accessToken을 알 수 없다.\u003cbr /\u003e\u003cbr /\u003e\\n        \\n        CSRF는 피해자의 컴퓨터를 제어할 수 있는 것이 아니기 때문이다. 요청을 위조하여 피해자가 의도하지 않은 서버 동작을 일으키는 공격방법이기 때문에 refresh token을 통해 받아온 response(accessToken)는 공격자가 확인할 수 없다.\u003cbr /\u003e\u003cbr /\u003e\\n        \\n        따라서 쿠키를 사용하여 XSS를 막고 refresh token 방식을 이용하여 CSRF를 막을 수 있다.\"}}]],[\"$\",\"$La\",null,{\"postid\":1,\"prePostTitle\":{\"id\":2,\"title\":\"프로미스(Promise)의 세 가지 상태와 활용\",\"date\":\"2022-09-07 22:11:33\",\"folder\":\"Javascript\",\"preview\":\"프로미스를 사용할 때 알아야 하는 가장 기본적인 개념이 바로 프로미스의 상태(states)입니다. 여기서 말하는 상태란 프로미스의 처리 과정을 의미합니다. new Promise()로 프로미스를 생성하고 종료될 때까지 3가지 상태를 갖습니다..\\n    \",\"tag\":[\"JavaScript\"],\"post\":[{\"type\":\"normal\",\"value\":\"프로미스는 비동기 처리를 위한 패턴 중 하나로, 세 가지 상태를 가지며 각각의 상태에 따라 처리 과정이 이뤄집니다.\"},{\"type\":\"Heading\",\"headingType\":\"h2\",\"value\":\"1. Pending(대기) 상태\"},{\"type\":\"normal\",\"value\":\"프로미스가 생성되고 아직 비동기 처리가 완료되지 않은 초기 상태를 \\\"대기\\\" 상태라고 합니다. 아래는 프로미스를 생성하는 예제입니다.\"},{\"type\":\"code\",\"value\":\"const myPromise = new Promise((resolve, reject) =\u003e {\\n  // 비동기 처리 로직...\\n});\\n        \"},{\"type\":\"Heading\",\"headingType\":\"h2\",\"value\":\"2. Fulfilled(이행) 상태\"},{\"type\":\"normal\",\"value\":\"비동기 처리가 성공적으로 완료되면 프로미스는 \\\"이행\\\" 상태가 됩니다. resolve 함수를 호출하여 상태를 변경합니다.\"},{\"type\":\"code\",\"value\":\"const myPromise = new Promise((resolve, reject) =\u003e {\\n  const data = \\\"Success!\\\";\\n  resolve(data);\\n});\\n\\nmyPromise.then((result) =\u003e {\\n  console.log(result); // \\\"Success!\\\"\\n});\\n        \"},{\"type\":\"Heading\",\"headingType\":\"h2\",\"value\":\"3. Rejected(실패) 상태\"},{\"type\":\"normal\",\"value\":\"비동기 처리 중 오류가 발생하면 프로미스는 \\\"실패\\\" 상태가 됩니다. reject 함수를 호출하여 상태를 변경합니다.\"},{\"type\":\"code\",\"value\":\"const myPromise = new Promise((resolve, reject) =\u003e {\\n  const error = new Error(\\\"Something went wrong!\\\");\\n  reject(error);\\n});\\n\\nmyPromise.catch((error) =\u003e {\\n  console.error(error.message); // \\\"Something went wrong!\\\"\\n});\"},{\"type\":\"normal\",\"value\":\"프로미스를 사용하면 콜백 지옥을 피하고 비동기 코드를 더 간결하게 작성할 수 있습니다.\"},{\"type\":\"code\",\"value\":\"function fetchData() {\\n  return new Promise((resolve, reject) =\u003e {\\n    setTimeout(() =\u003e {\\n      const success = true;\\n      if (success) {\\n        resolve(\\\"Data fetched successfully!\\\");\\n      } else {\\n        reject(\\\"Error fetching data\\\");\\n      }\\n    }, 2000);\\n  });\\n}\\n\\nfetchData()\\n  .then((result) =\u003e {\\n    console.log(result); // \\\"Data fetched successfully!\\\"\\n  })\\n  .catch((error) =\u003e {\\n    console.error(error); // \\\"Error fetching data\\\"\\n  });\"},{\"type\":\"normal\",\"value\":\"프로미스를 사용하면 비동기 코드를 일관된 방식으로 처리하고, 세 가지 상태를 활용하여 처리 결과를 명확하게 다룰 수 있습니다. 이를 통해 코드의 가독성과 유지보수성이 향상됩니다.\"}]},\"nextPostTile\":\"$undefined\",\"segment\":\"posts\"}],[\"$\",\"div\",null,{\"className\":\"footer_footer_container__MsSvO\",\"children\":[\"$\",\"footer\",null,{\"className\":\"footer_footer__AwYty\",\"children\":[[\"$\",\"p\",null,{\"className\":\"footer_copylight___J5l0\",\"children\":[\"© 2024 \",\"베짱이가 되고싶은 개미。\",\" Some rights reserved.\"]}],[\"$\",\"p\",null,{\"className\":\"footer_theme__bwXbg\",\"children\":\"portfolio v1.0.0-alpha.3\"}]]}]}]],null]]},[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(layoutCase)\",\"children\",\"tags\",\"children\",\"$c\",\"children\",\"$d\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Le\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/175d6c648827cdb6.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]]}]]},[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(layoutCase)\",\"children\",\"tags\",\"children\",\"$c\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Le\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]]},[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(layoutCase)\",\"children\",\"tags\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Le\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]],\"search\":[\"__DEFAULT__\",{},[\"$f\",\"$L11\",null]]},[null,[\"$\",\"$L12\",null,{\"children\":[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(layoutCase)\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Le\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"styles\":null}],\"search\":[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"search\",\"segmentPath\":[\"children\",\"(layoutCase)\",\"search\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Le\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$13\",\"styles\":null}],\"params\":{}}],null]]},[null,[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"href\":\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css\",\"as\":\"style\"}],[\"$\",\"link\",null,{\"rel\":\"preconnect\",\"href\":\"https://fonts.googleapis.com\"}],[\"$\",\"link\",null,{\"rel\":\"preconnect\",\"href\":\"https://fonts.gstatic.com\"}],[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"href\":\"https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+KR\u0026display=swap\",\"as\":\"style\"}]]}],[\"$\",\"body\",null,{\"children\":[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Le\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":\"$14\",\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":\"$15\",\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":\"$16\",\"children\":[\"$\",\"h2\",null,{\"style\":\"$17\",\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/0c496b0e03d530ba.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]]}]}]]}],null]],\"initialHead\":[false,\"$L18\"],\"globalErrorComponent\":\"$19\"}]]\n"])</script><script>self.__next_f.push([1,"11:E{\"digest\":\"NEXT_NOT_FOUND\"}\n"])</script><script>self.__next_f.push([1,"18:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"be come 💡\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"App for an Ant Who Wants to Become a Bejjangyi\"}]]\n6:null\n10:null\n"])</script><script>self.__next_f.push([1,""])</script></body></html>